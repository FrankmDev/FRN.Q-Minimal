---
import CustomCursor from '../components/CustomCursor.astro';

interface Props {
  title?: string;
  description?: string;
  ogImage?: string;
}

const {
  title = "FRN.Q — Diseño Que Vende",
  description = "Portfolio de Francisco Muñoz. Desarrollo webs y aplicaciones que convierten visitantes en clientes.",
  ogImage = "/og-image.jpg",
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site || "https://frnq.es");
---

<!doctype html>
<html lang="es" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="author" content="Francisco Muñoz" />
    <meta name="theme-color" content="#0a0a0a" media="(prefers-color-scheme: dark)" />
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)" />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL} />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage} />
    <meta property="og:locale" content="es_ES" />
    <meta property="og:site_name" content="FRN.Q Studio" />
    
    <!-- Twitter Card -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={canonicalURL} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={ogImage} />
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    
    <!-- Fonts - Optimized loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Manrope:wght@300;400;500;600;700;800&display=swap"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <noscript>
      <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Manrope:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet"
      />
    </noscript>
    
    <!-- JSON-LD Structured Data - B2B Professional Service -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "ProfessionalService",
      "name": "FRN.Q Studio - Desarrollo de Infraestructuras Web Premium",
      "alternateName": "FRN.Q Studio",
      "description": "Consultoría digital especializada en desarrollo web a medida para empresas. Infraestructuras digitales de alto rendimiento sin plantillas.",
      "url": canonicalURL,
      "email": "hola@frnq.es",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Granada",
        "addressCountry": "ES"
      },
      "serviceType": [
        "Desarrollo web a medida",
        "Consultoría digital B2B",
        "Infraestructura web empresarial",
        "Optimización de conversión",
        "Arquitectura web escalable",
        "Diseño web corporativo premium"
      ],
      "areaServed": {
        "@type": "Country",
        "name": "España"
      },
      "priceRange": "€€€€",
      "knowsAbout": [
        "Desarrollo web empresarial",
        "Optimización de rendimiento web",
        "Arquitectura digital B2B",
        "UX/UI para conversión",
        "Infraestructuras sin plantillas"
      ],
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Servicios de Infraestructura Digital",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Desarrollo Web Premium B2B",
              "description": "Infraestructuras digitales a medida para empresas que buscan diferenciación"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Consultoría de Transformación Digital",
              "description": "Asesoramiento estratégico para optimizar presencia digital empresarial"
            }
          }
        ]
      }
    })} />

    <slot name="head" />

    <!-- Theme initialization - CRITICAL: prevent flash -->
    <script is:inline>
      (function() {
        const savedTheme = localStorage.getItem("theme");
        const theme = savedTheme || "light";
        document.documentElement.setAttribute("data-theme", theme);
        document.documentElement.style.colorScheme = theme;
      })();
    </script>
  </head>

  <body>
    <slot />
    
    <!-- Custom cursor component -->
    <CustomCursor />
    
    <!-- Skip to content link for accessibility -->
    <a href="#main-content" class="skip-link">Saltar al contenido</a>
  </body>
</html>

<style is:global>
  /* ============================================
     DESIGN TOKENS - Unified CSS Variables
     ============================================ */
  
  :root {
    /* Typography */
    --font-sans: "Manrope", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    --font-mono: "JetBrains Mono", "SF Mono", "Fira Code", monospace;
    
    /* Spacing Scale */
    --space-xs: 0.25rem;
    --space-sm: 0.5rem;
    --space-md: 1rem;
    --space-lg: 1.5rem;
    --space-xl: 2rem;
    --space-2xl: 3rem;
    --space-3xl: 4rem;
    --space-4xl: 6rem;
    
    /* Transitions */
    --transition-fast: 150ms cubic-bezier(0.16, 1, 0.3, 1);
    --transition-base: 300ms cubic-bezier(0.16, 1, 0.3, 1);
    --transition-slow: 500ms cubic-bezier(0.16, 1, 0.3, 1);
    
    /* Border Radius */
    --radius-none: 0;
    --radius-sm: 0.25rem;
    
    /* Z-index Scale */
    --z-base: 0;
    --z-dropdown: 100;
    --z-sticky: 200;
    --z-fixed: 300;
    --z-modal-backdrop: 400;
    --z-modal: 500;
    --z-popover: 600;
    --z-tooltip: 700;
  }

  /* Light Theme (default) */
  :root,
  [data-theme="light"] {
    --bg: #ffffff;
    --bg-alt: #f5f5f5;
    --bg-elevated: #fafafa;
    
    --text: #0a0a0a;
    --text-secondary: #333333;
    --text-muted: #666666;
    
    --border: #0a0a0a;
    --border-light: rgba(10, 10, 10, 0.15);
    --border-strong: #0a0a0a;
    
    --shadow: rgba(10, 10, 10, 0.12);
    --shadow-brutal: 4px 4px 0 0 #0a0a0a;
    --shadow-brutal-hover: 8px 8px 0 0 #0a0a0a;
    --shadow-brutal-lg: 12px 12px 0 0 #0a0a0a;
    
    /* Legacy aliases for backwards compatibility */
    --color-bg: #ffffff;
    --color-bg-alt: #f5f5f5;
    --color-bg-elevated: #fafafa;
    --color-text: #0a0a0a;
    --color-text-secondary: #333333;
    --color-text-muted: #666666;
    --color-border: #0a0a0a;
    --color-border-light: rgba(10, 10, 10, 0.15);
    --color-border-strong: #0a0a0a;
  }

  /* Dark Theme */
  [data-theme="dark"] {
    --bg: #0a0a0a;
    --bg-alt: #141414;
    --bg-elevated: #1a1a1a;
    
    --text: #ffffff;
    --text-secondary: #e5e5e5;
    --text-muted: #999999;
    
    --border: #ffffff;
    --border-light: rgba(255, 255, 255, 0.15);
    --border-strong: #ffffff;
    
    --shadow: rgba(255, 255, 255, 0.08);
    --shadow-brutal: 4px 4px 0 0 rgba(255, 255, 255, 0.12);
    --shadow-brutal-hover: 6px 6px 0 0 rgba(255, 255, 255, 0.15);
    --shadow-brutal-lg: 8px 8px 0 0 rgba(255, 255, 255, 0.12);
    
    /* Legacy aliases */
    --color-bg: #0a0a0a;
    --color-bg-alt: #141414;
    --color-bg-elevated: #1a1a1a;
    --color-text: #ffffff;
    --color-text-secondary: #e5e5e5;
    --color-text-muted: #999999;
    --color-border: #ffffff;
    --color-border-light: rgba(255, 255, 255, 0.15);
    --color-border-strong: #ffffff;
  }

  /* ============================================
     RESET & BASE STYLES
     ============================================ */
  *,
  *::before,
  *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  html {
    scroll-behavior: smooth;
    -webkit-text-size-adjust: 100%;
    -moz-tab-size: 4;
    tab-size: 4;
  }

  @media (prefers-reduced-motion: reduce) {
    html {
      scroll-behavior: auto;
    }
  }

  body {
    font-family: var(--font-sans);
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-feature-settings: "kern" 1, "liga" 1;
    transition: background-color var(--transition-base), color var(--transition-base);
    min-height: 100vh;
    min-height: 100dvh;
  }

  /* Typography */
  h1, h2, h3, h4, h5, h6 {
    font-weight: 700;
    line-height: 1.2;
    letter-spacing: -0.02em;
    text-wrap: balance;
  }

  p {
    text-wrap: pretty;
  }

  a {
    color: inherit;
    text-decoration: none;
  }

  img, picture, video, canvas, svg {
    display: block;
    max-width: 100%;
    height: auto;
  }

  input, button, textarea, select {
    font: inherit;
    color: inherit;
  }

  button {
    cursor: pointer;
    background: none;
    border: none;
  }

  /* ============================================
     UTILITY CLASSES
     ============================================ */
  .container {
    width: 100%;
    max-width: 1280px;
    margin: 0 auto;
    padding: 0 var(--space-md);
  }

  @media (min-width: 640px) {
    .container {
      padding: 0 var(--space-lg);
    }
  }

  @media (min-width: 1024px) {
    .container {
      padding: 0 var(--space-xl);
    }
  }

  .font-mono {
    font-family: var(--font-mono);
  }

  /* Skip link for accessibility */
  .skip-link {
    position: absolute;
    top: -100%;
    left: var(--space-md);
    z-index: 9999;
    padding: var(--space-sm) var(--space-md);
    background: var(--text);
    color: var(--bg);
    font-weight: 600;
    font-size: 0.875rem;
    transition: top var(--transition-fast);
  }

  .skip-link:focus {
    top: var(--space-md);
  }

  /* ============================================
     ACCESSIBILITY
     ============================================ */
  
  /* Focus styles */
  :focus-visible {
    outline: 3px solid var(--text);
    outline-offset: 3px;
    border-radius: var(--radius-sm);
  }

  /* Remove focus outline for mouse users */
  :focus:not(:focus-visible) {
    outline: none;
  }

  /* Screen reader only */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  /* Selection */
  ::selection {
    background: var(--text);
    color: var(--bg);
  }

  /* ============================================
     SCROLLBAR
     ============================================ */
  ::-webkit-scrollbar {
    width: 12px;
    height: 12px;
  }

  ::-webkit-scrollbar-track {
    background: var(--bg-alt);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--text);
    border: 3px solid var(--bg-alt);
    border-radius: 6px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--text-secondary);
  }

  /* Firefox */
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--text) var(--bg-alt);
  }

  /* ============================================
     ANIMATIONS
     ============================================ */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes marquee {
    from { transform: translateX(0); }
    to { transform: translateX(-50%); }
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }

    .marquee-track {
      animation: none !important;
    }
  }

  /* ============================================
     REVEAL ANIMATIONS (Intersection Observer)
     ============================================ */
  .reveal {
    opacity: 0;
    transform: translateY(24px);
    transition: opacity var(--transition-slow), transform var(--transition-slow);
    will-change: opacity, transform;
  }

  .reveal.visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* ============================================
     PRINT STYLES
     ============================================ */
  @media print {
    *,
    *::before,
    *::after {
      background: transparent !important;
      color: #000 !important;
      box-shadow: none !important;
      text-shadow: none !important;
    }
    
    a[href]::after {
      content: " (" attr(href) ")";
    }
    
    .skip-link,
    .header,
    .footer,
    .theme-toggle,
    .hamburger,
    .back-top {
      display: none !important;
    }
  }

  /* ============================================
     CUSTOM CURSOR
     ============================================ */
  
  .custom-cursor {
    position: fixed;
    top: 0;
    left: 0;
    width: 24px;
    height: 24px;
    pointer-events: none;
    z-index: 10001;
    mix-blend-mode: difference;
    opacity: 0;
    transform: translate(-50%, -50%);
    transition: opacity 0.2s ease;
  }

  .custom-cursor.visible {
    opacity: 1;
  }

  .custom-cursor.force-hidden {
    opacity: 0 !important;
    display: none !important;
  }

  .cursor-dot {
    width: 100%;
    height: 100%;
    background: #ffffff;
    border-radius: 50%;
    transition: transform 0.15s cubic-bezier(0.16, 1, 0.3, 1);
    will-change: transform;
  }

  /* Hover effect on links - cursor grows */
  .custom-cursor.hovering .cursor-dot {
    transform: scale(2);
  }

  /* Click effect */
  .custom-cursor.clicking .cursor-dot {
    transform: scale(1.5);
  }

  .custom-cursor.hovering.clicking .cursor-dot {
    transform: scale(3);
  }

  /* Hide default cursor on desktop */
  @media (hover: hover) and (pointer: fine) {
    html {
      cursor: none;
    }

    a,
    button,
    [role="button"],
    input[type="submit"],
    input[type="button"],
    label[for],
    select,
    summary,
    [data-cursor-hover] {
      cursor: none;
    }
  }

  /* Hide custom cursor on touch devices */
  @media (hover: none), (pointer: coarse) {
    .custom-cursor {
      display: none !important;
    }

    html,
    a,
    button,
    [role="button"],
    input[type="submit"],
    input[type="button"],
    label[for],
    select,
    summary {
      cursor: auto !important;
    }
  }

  /* Also hide on small screens regardless of pointer type */
  @media (max-width: 768px) {
    .custom-cursor {
      display: none !important;
    }

    html,
    a,
    button,
    [role="button"],
    input[type="submit"],
    input[type="button"],
    label[for],
    select,
    summary {
      cursor: auto !important;
    }
  }

  /* Respect reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    .cursor-dot {
      transition: none;
    }
  }
</style>
